# √âtape 5 : Voir le D√©tail d'un Ticket

**Objectif** : Cliquer sur un ticket pour voir tous ses d√©tails

## Ce qu'on livre

- Page de d√©tail d'un ticket (`/tickets/[id]`)
- Affiche titre, description compl√®te, statut, dates
- Bouton retour vers la liste

## T√¢ches

- [x] Cr√©er l'API route `GET /api/tickets/[id]`
- [x] Cr√©er la page `/tickets/[id]/page.tsx`
- [x] Cr√©er le composant `TicketDetail` avec tests
- [x] Rendre les tickets cliquables dans la liste
- [x] G√©rer le cas "ticket non trouv√©"
- [x] Ajouter la m√©thode `findById` dans l'architecture hexagonale
  - [x] Interface ITicketRepository
  - [x] Impl√©mentation MongoTicketRepository
  - [x] Use case GetTicketById
  - [x] TicketService.getTicketById
- [x] Tests unitaires (80 tests au total)
- [x] Build Next.js r√©ussi
- [ ] D√©ployer

## Validation

- ‚úÖ Cliquer sur un ticket ouvre sa page de d√©tail
- ‚úÖ Toutes les infos sont affich√©es
- ‚úÖ Le bouton retour fonctionne
- ‚úÖ URL avec mauvais ID affiche une erreur propre (page not-found)
- ‚úÖ Architecture hexagonale respect√©e
- ‚úÖ Tous les tests passent (80 tests)
- ‚è≥ D√©ploy√© en production (en attente du push git)

---

## üîß Refactorisation : √âliminer la duplication de code

**Objectif** : Supprimer le code dupliqu√© entre TicketCard et TicketDetail

### Ce qu'on livre

- Constantes partag√©es pour les couleurs et labels de statut
- Fonctions de formatage de date r√©utilisables
- Tests unitaires pour les utilitaires
- Composants refactoris√©s sans duplication

### T√¢ches

- [x] Cr√©er `src/presentation/constants/ticketDisplay.ts`
  - [x] Exporter `statusColors` (mapping couleurs Tailwind par statut)
  - [x] Exporter `statusLabels` (mapping labels fran√ßais par statut)
- [x] Cr√©er `src/presentation/utils/ticketFormatters.ts`
  - [x] Fonction `formatTicketDate` (date seule pour les listes)
  - [x] Fonction `formatTicketDateTime` (date + heure pour les d√©tails)
- [x] Cr√©er les tests `src/presentation/utils/ticketFormatters.test.ts`
- [x] Refactoriser `TicketCard.tsx`
  - [x] Supprimer constantes dupliqu√©es
  - [x] Importer et utiliser les utilitaires partag√©s
- [x] Refactoriser `TicketDetail.tsx`
  - [x] Supprimer constantes dupliqu√©es
  - [x] Importer et utiliser les utilitaires partag√©s
- [x] Valider avec les tests
- [x] Valider avec TypeScript compilation
- [x] Build Next.js r√©ussi

### Validation

- ‚úÖ Tous les tests passent (85 tests, +6 nouveaux tests)
- ‚úÖ TypeScript compile sans erreur
- ‚úÖ Build Next.js r√©ussi
- ‚úÖ Aucun code dupliqu√© entre TicketCard et TicketDetail
- ‚úÖ L'affichage des tickets reste identique
- ‚úÖ Principe YAGNI respect√© (extraction minimale n√©cessaire)

### Notes techniques

**Structure cr√©√©e** :

- `src/presentation/constants/` - Constantes d'affichage
- `src/presentation/utils/` - Fonctions utilitaires

**Avantages** :

- DRY (Don't Repeat Yourself) - une seule source de v√©rit√©
- Facilite les modifications futures (changement de couleurs, formats, etc.)
- Tests unitaires ind√©pendants pour les utilitaires
- Coh√©rence garantie entre les composants
